# æ•°æ®åº“ç®¡ç†è„šæœ¬

è¿™ä¸ªç›®å½•åŒ…å«äº†ç”¨äºç®¡ç†ç°ä»£åŒ–åå°ç®¡ç†ç³»ç»Ÿæ•°æ®åº“çš„å„ç§è„šæœ¬ã€‚

## è„šæœ¬åˆ—è¡¨

### 1. init_database.py - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

**åŠŸèƒ½ï¼š** åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„å¹¶åˆå§‹åŒ–åŸºç¡€æ•°æ®

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
python scripts/init_database.py
```

**æ‰§è¡Œå†…å®¹ï¼š**
- åˆ›å»ºæ‰€æœ‰æ•°æ®åº“è¡¨ï¼ˆç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€æ—¥å¿—ç­‰ï¼‰
- åˆå§‹åŒ–14ä¸ªåŸºç¡€æƒé™
- åˆ›å»º5ä¸ªç³»ç»Ÿè§’è‰²ï¼ˆsuper_adminã€adminã€user_managerã€viewerã€userï¼‰
- åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆç”¨æˆ·åï¼šadminï¼Œå¯†ç ï¼šAdmin123456ï¼‰
- ç”Ÿæˆåˆå§‹æ•°æ®åº“è¿ç§»æ–‡ä»¶

**æ³¨æ„äº‹é¡¹ï¼š**
- é¦–æ¬¡è¿è¡Œæ—¶ä¼šåˆ›å»ºæ‰€æœ‰è¡¨å’ŒåŸºç¡€æ•°æ®
- é‡å¤è¿è¡Œæ—¶ä¼šè·³è¿‡å·²å­˜åœ¨çš„æ•°æ®
- è¯·åœ¨é¦–æ¬¡ç™»å½•åä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 

### 2. check_database.py - æ•°æ®åº“çŠ¶æ€æ£€æŸ¥è„šæœ¬

**åŠŸèƒ½ï¼š** æ£€æŸ¥æ•°æ®åº“è¿æ¥çŠ¶æ€å’ŒåŸºç¡€æ•°æ®å®Œæ•´æ€§

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
python scripts/check_database.py
```

**æ£€æŸ¥å†…å®¹ï¼š**
- æ•°æ®åº“è¿æ¥çŠ¶æ€
- è¡¨ç»“æ„å®Œæ•´æ€§
- åŸºç¡€æ•°æ®ç»Ÿè®¡
- ç®¡ç†å‘˜è´¦æˆ·çŠ¶æ€

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
ğŸ“¡ æ£€æŸ¥æ•°æ®åº“è¿æ¥...
âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸

ğŸ“‹ æ£€æŸ¥è¡¨ç»“æ„...
  å‘ç° 7 ä¸ªè¡¨
    âœ“ users
    âœ“ roles
    âœ“ permissions
    âœ“ user_roles
    âœ“ role_permissions
    âœ“ login_logs
    âœ“ operation_logs

ğŸ“ˆ æ•°æ®åº“ç»Ÿè®¡:
  è¡¨æ•°é‡: 7
  ç”¨æˆ·æ•°é‡: 1
  è§’è‰²æ•°é‡: 5
  æƒé™æ•°é‡: 14
  ç™»å½•æ—¥å¿—æ•°é‡: 0
  æ“ä½œæ—¥å¿—æ•°é‡: 1

ğŸ‘¤ æ£€æŸ¥ç®¡ç†å‘˜è´¦æˆ·...
âœ… ç®¡ç†å‘˜è´¦æˆ·å­˜åœ¨
  ç”¨æˆ·å: admin
  é‚®ç®±: admin@example.com
  çŠ¶æ€: æ¿€æ´»
  è§’è‰²æ•°é‡: 1
```

### 3. migrate.py - æ•°æ®åº“è¿ç§»ç®¡ç†è„šæœ¬

**åŠŸèƒ½ï¼š** ç®¡ç†æ•°æ®åº“è¿ç§»çš„åˆ›å»ºã€æ‰§è¡Œå’Œå›æ»š

**ä½¿ç”¨æ–¹æ³•ï¼š**

åˆ›å»ºæ–°è¿ç§»ï¼š
```bash
python scripts/migrate.py create <migration_name>
```

åˆ—å‡ºæ‰€æœ‰è¿ç§»ï¼š
```bash
python scripts/migrate.py list
```

æ‰§è¡Œæ‰€æœ‰è¿ç§»å‡çº§ï¼š
```bash
python scripts/migrate.py upgrade
```

æ‰§è¡Œæ‰€æœ‰è¿ç§»é™çº§ï¼š
```bash
python scripts/migrate.py downgrade
```

è¿è¡ŒæŒ‡å®šè¿ç§»ï¼š
```bash
python scripts/migrate.py run <migration_file> <upgrade|downgrade>
```

### 4. reset_database.py - æ•°æ®åº“é‡ç½®è„šæœ¬

**åŠŸèƒ½ï¼š** åˆ é™¤æ‰€æœ‰æ•°æ®å¹¶é‡æ–°åˆå§‹åŒ–æ•°æ®åº“

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
python scripts/reset_database.py
```

**è­¦å‘Šï¼š** 
- è¿™ä¸ªæ“ä½œä¼šåˆ é™¤æ‰€æœ‰ç°æœ‰æ•°æ®ï¼
- æ‰§è¡Œå‰ä¼šè¦æ±‚ç¡®è®¤ï¼ˆè¾“å…¥ 'yes'ï¼‰
- é€‚ç”¨äºå¼€å‘ç¯å¢ƒï¼Œç”Ÿäº§ç¯å¢ƒè¯·è°¨æ…ä½¿ç”¨

**æ‰§è¡Œæµç¨‹ï¼š**
1. åˆ é™¤æ‰€æœ‰ç°æœ‰è¡¨
2. é‡æ–°åˆ›å»ºè¡¨ç»“æ„
3. é‡æ–°åˆå§‹åŒ–åŸºç¡€æ•°æ®
4. é‡æ–°åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·

## åˆå§‹åŒ–æ•°æ®è¯¦æƒ…

### é»˜è®¤æƒé™åˆ—è¡¨

| æƒé™åç§° | æè¿° | èµ„æº | æ“ä½œ |
|---------|------|------|------|
| user.view | æŸ¥çœ‹ç”¨æˆ· | user | view |
| user.create | åˆ›å»ºç”¨æˆ· | user | create |
| user.update | æ›´æ–°ç”¨æˆ· | user | update |
| user.delete | åˆ é™¤ç”¨æˆ· | user | delete |
| role.view | æŸ¥çœ‹è§’è‰² | role | view |
| role.create | åˆ›å»ºè§’è‰² | role | create |
| role.update | æ›´æ–°è§’è‰² | role | update |
| role.delete | åˆ é™¤è§’è‰² | role | delete |
| permission.view | æŸ¥çœ‹æƒé™ | permission | view |
| permission.assign | åˆ†é…æƒé™ | permission | assign |
| system.config | ç³»ç»Ÿé…ç½® | system | config |
| system.monitor | ç³»ç»Ÿç›‘æ§ | system | monitor |
| log.view | æŸ¥çœ‹æ—¥å¿— | log | view |
| log.export | å¯¼å‡ºæ—¥å¿— | log | export |

### é»˜è®¤è§’è‰²åˆ—è¡¨

| è§’è‰²åç§° | æè¿° | æƒé™ |
|---------|------|------|
| super_admin | è¶…çº§ç®¡ç†å‘˜ | æ‰€æœ‰æƒé™ |
| admin | ç®¡ç†å‘˜ | å¤§éƒ¨åˆ†ç®¡ç†æƒé™ |
| user_manager | ç”¨æˆ·ç®¡ç†å‘˜ | ç”¨æˆ·ç®¡ç†ç›¸å…³æƒé™ |
| viewer | æŸ¥çœ‹è€… | åªè¯»æƒé™ |
| user | æ™®é€šç”¨æˆ· | åŸºç¡€æƒé™ |

### é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·

- **ç”¨æˆ·åï¼š** admin
- **å¯†ç ï¼š** Admin123456
- **é‚®ç®±ï¼š** admin@example.com
- **è§’è‰²ï¼š** super_admin
- **çŠ¶æ€ï¼š** æ¿€æ´»

## ä½¿ç”¨å»ºè®®

### å¼€å‘ç¯å¢ƒ

1. é¦–æ¬¡è®¾ç½®ï¼š
   ```bash
   python scripts/init_database.py
   ```

2. å®šæœŸæ£€æŸ¥ï¼š
   ```bash
   python scripts/check_database.py
   ```

3. é‡ç½®å¼€å‘æ•°æ®ï¼š
   ```bash
   python scripts/reset_database.py
   ```

### ç”Ÿäº§ç¯å¢ƒ

1. åˆå§‹åŒ–ï¼š
   ```bash
   python scripts/init_database.py
   ```

2. çŠ¶æ€ç›‘æ§ï¼š
   ```bash
   python scripts/check_database.py
   ```

3. è¿ç§»ç®¡ç†ï¼š
   ```bash
   python scripts/migrate.py upgrade
   ```

## æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æ€§ï¼š** é»˜è®¤ç®¡ç†å‘˜å¯†ç å¿…é¡»åœ¨é¦–æ¬¡ç™»å½•åä¿®æ”¹
2. **å¤‡ä»½ï¼š** ç”Ÿäº§ç¯å¢ƒæ“ä½œå‰è¯·å…ˆå¤‡ä»½æ•°æ®åº“
3. **æƒé™ï¼š** ç¡®ä¿è„šæœ¬æœ‰è¶³å¤Ÿçš„æ•°æ®åº“æ“ä½œæƒé™
4. **ç¯å¢ƒï¼š** è„šæœ¬ä¼šè‡ªåŠ¨åŠ è½½ `.env` æ–‡ä»¶ä¸­çš„é…ç½®
5. **æ—¥å¿—ï¼š** æ‰€æœ‰æ“ä½œéƒ½ä¼šè®°å½•è¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®
   - ç¡®è®¤æ•°æ®åº“æœåŠ¡æ˜¯å¦è¿è¡Œ
   - æ£€æŸ¥æ•°æ®åº“æƒé™

2. **è¡¨å·²å­˜åœ¨é”™è¯¯**
   - ä½¿ç”¨ `reset_database.py` é‡ç½®æ•°æ®åº“
   - æˆ–æ‰‹åŠ¨åˆ é™¤ç°æœ‰è¡¨

3. **æƒé™ä¸è¶³**
   - ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æœ‰åˆ›å»ºè¡¨çš„æƒé™
   - æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæƒé™

4. **æ¨¡å—å¯¼å…¥é”™è¯¯**
   - ç¡®è®¤åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œè„šæœ¬
   - æ£€æŸ¥ Python è·¯å¾„é…ç½®

### è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹è„šæœ¬è¾“å‡ºçš„è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
3. è¿è¡Œ `check_database.py` è¯Šæ–­é—®é¢˜
4. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£